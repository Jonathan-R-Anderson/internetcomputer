# kernel-mainline.recipe
# Recipe for building the WorldComputer kernel.

# --- Metadata ---
name: "worldcomputer-kernel"
version: "0.1.0-dev" # Version of the kernel package
description: "The core WorldComputer operating system kernel."
license: "Proprietary" # Or your chosen license

# --- Source ---
# Defines where to get the source code for the kernel.
source: {
    type: "local",
    # Path relative to the root of the WorldComputer project,
    # pointing to your kernel's source directory.
    path: "kernel"
}

# --- Dependencies ---
# List of other recipes this component depends on.
# For the kernel, this might include specific versions of build tools
# if you want to ensure a reproducible toolchain.
dependencies: [
    # "recipe:toolchain-ldc-x86_64-elf",
    # "recipe:toolchain-nasm-x86_64"
]

# --- Build Process ---
# Commands to build the kernel.
# The build system would execute these in an isolated environment.
# ${source_dir} is the path to the fetched/local source.
# ${build_dir} is a temporary directory for intermediate build files.
build: [
    "cd ${source_dir}",
    "make -f Makefile.mk clean",
    "make -f Makefile.mk kernel.bin"
]

# --- Installation ---
# How to install the built kernel into the system image staging area.
# ${install_root} is the root of the staging area for the OS image.
install: [
    "mkdir -p ${install_root}/boot",
    "cp ${source_dir}/build/kernel.bin ${install_root}/boot/worldcomputer.kernel"
]